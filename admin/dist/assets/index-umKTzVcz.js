import{j as e,T as D,r as n,u as F,ay as o,B as C,a as b,W as R,ab as H,Q as M,R as U}from"./index-UxWg3ezt.js";import{P as O}from"./index-1cljy8ee.js";import{M as Q}from"./MenuItem-4mY932aB.js";import{C as V}from"./Checkbox-tc_mldm7.js";import{L as z}from"./ListItemText-TFsj42vs.js";import{T as _}from"./TextField-EtPTPldC.js";import{F as J}from"./FormControl-kAW0uwil.js";import{I as K}from"./InputLabel-dtf-HdNi.js";import{S as N}from"./Select-Mt5imv_x.js";import{C as X}from"./Chip-CG61bexS.js";import{C as Y}from"./Container-tCW55QtL.js";import{G as k}from"./Grid-7WI3L6ty.js";import{T as Z,a as $,b as w,c as E,d as p,e as ee}from"./TableRow-a8LrD-6U.js";import{E as te,D as se,C as ie,a as ne,b as le,c as oe}from"./Edit-vbW1gcSi.js";import{D as re,a as ae}from"./DialogTitle-Lg5rTFAR.js";import"./listItemIconClasses-4JdzJs8a.js";import"./listItemTextClasses-2n_E-t3u.js";import"./SwitchBase-IHTtuvnj.js";import"./useFormControl-3FAv15pH.js";import"./FormHelperText-tsMyAYUM.js";import"./OutlinedInput-10KJ4yo_.js";import"./react-is.production.min-pGgGHoNV.js";function ce(){return e.jsxs(e.Fragment,{children:[e.jsx(D,{variant:"h3",component:"h3",gutterBottom:!0,children:"Lists"}),e.jsx(D,{variant:"subtitle2",children:"Manage movies lists"})]})}const de=({callback:g,item:l})=>{const[a,f]=n.useState(""),[d,v]=n.useState(""),[c,u]=n.useState(""),[x,m]=n.useState(""),[r,T]=n.useState([]),[t,h]=n.useState([]),y=F(),I=()=>{f(""),v(""),u(""),m(""),h([])},L=n.useCallback(s=>{f(s.title),u(s.type),m(s.genre),h(r.filter(i=>{var j;return(j=s.content)==null?void 0:j.includes(i._id)}))},[r]),A=()=>{y.getMovies().then(s=>{T(s)}).catch(s=>{console.error(s)})},W=n.useCallback(()=>{const s={title:a,content:t.map(i=>i._id),type:c,genre:x};o.loading("saving...",{position:"top-right"}),y.createList(s).then(()=>{o.dismiss(),o.success("saved",{position:"top-right"}),I(),g&&g()}).catch(i=>{o.dismiss(),o.error("failed",{position:"top-right"}),console.error(i)})},[a,d,c,x,t]),B=n.useCallback(()=>{const s={title:a,description:d,type:c,genre:x,content:t.map(i=>i._id)};console.log(s),o.loading("saving...",{position:"top-right"}),y.updateList(l._id,s).then(()=>{o.dismiss(),o.success("saved",{position:"top-right"}),g&&g()}).catch(i=>{o.dismiss(),o.error("failed",{position:"top-right"}),console.error(i)})},[a,d,c,x,l,t]),G=n.useMemo(()=>{const s=[];for(const i of r)s.push(e.jsxs(Q,{value:i._id,children:[e.jsx(V,{checked:t.map(j=>j._id).includes(i._id)}),e.jsx(z,{primary:i.title})]},i._id));return s},[r,t]);return n.useEffect(()=>{A(),l!=null&&L(l),console.log(l==null?void 0:l.title)},[l]),n.useEffect(()=>{l!=null&&L(l)},[r]),e.jsx(e.Fragment,{children:e.jsxs(C,{component:"form",sx:{"& .MuiTextField-root":{m:1}},children:[e.jsx(_,{label:"Title",fullWidth:!0,required:!0,value:a,onChange:s=>{f(s.target.value)}}),e.jsx(_,{label:"Type (either movies or series)",fullWidth:!0,required:!0,value:c,onChange:s=>{var i;u((i=s.target.value)==null?void 0:i.trim())}}),e.jsx(_,{label:"Genre (only one per list)",fullWidth:!0,required:!0,value:x,onChange:s=>{var i;m((i=s.target.value)==null?void 0:i.trim())}}),(r==null?void 0:r.length)>0?e.jsxs(J,{fullWidth:!0,sx:{marginLeft:1,marginTop:2},children:[e.jsx(K,{htmlFor:"content",children:"Content"}),e.jsx(N,{value:t.map(s=>s._id),onChange:s=>{const i=s.target.value,j=[];for(const P of i){const S=r.find(q=>q._id===P);S&&j.push(S)}h([...j])},renderValue:()=>e.jsx(C,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:t.map(s=>e.jsx(X,{label:s.title},s._id))}),id:"content",label:"Grouping",placeholder:"Select tags",multiple:!0,children:G})]}):null,e.jsx(C,{marginLeft:1,marginTop:3,children:l?e.jsx(b,{variant:"contained",onClick:B,children:"Update"}):e.jsx(b,{variant:"contained",onClick:W,children:"Save"})})]})})};function Ae(){const[g,l]=n.useState(!1),[a,f]=n.useState([]),[d,v]=n.useState(null),[c,u]=n.useState(null),x=F(),m=n.useCallback(()=>{o.loading("loading...",{position:"top-right"}),x.getAdminLists().then(t=>{o.dismiss(),console.log(t),f(t)})},[]),r=n.useCallback(t=>a.find(h=>h._id===t),[a]),T=n.useCallback(t=>{t!=null&&(o.loading("loading...",{position:"top-right"}),x.deleteList(t==null?void 0:t._id).then(()=>{o.dismiss(),o.success("deleted",{position:"top-right"}),u(null),m()}).catch(h=>{o.dismiss(),o.error("failed",{position:"top-right"}),console.error(h),u(null)}))},[]);return n.useEffect(()=>{m()},[]),n.useEffect(()=>{if(d!=null){const t=r(d._id);l(!!t)}},[d]),n.useEffect(()=>{g||v(null)},[g]),e.jsxs(e.Fragment,{children:[e.jsx(R,{children:e.jsx("title",{children:"Lists - Configurations"})}),e.jsx(O,{children:e.jsx(ce,{})}),e.jsxs(Y,{maxWidth:"lg",children:[e.jsxs(k,{container:!0,direction:"row",justifyContent:"center",alignItems:"stretch",spacing:3,children:[e.jsx(k,{item:!0,xs:12,children:e.jsx(b,{variant:"contained",onClick:()=>l(!0),children:"Add List"})}),e.jsx(k,{item:!0,xs:12,children:e.jsx(Z,{component:H,children:e.jsxs($,{"aria-label":"simple table",children:[e.jsx(w,{children:e.jsxs(E,{children:[e.jsx(p,{children:"Title"}),e.jsx(p,{align:"right",children:"Movies"}),e.jsx(p,{align:"right",children:"Type"}),e.jsx(p,{align:"right",children:"Genre"}),e.jsx(p,{align:"right",children:"Actions"})]})}),e.jsx(ee,{children:a==null?void 0:a.map(t=>{var h;return e.jsxs(E,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(p,{component:"th",scope:"row",children:t==null?void 0:t.title}),e.jsx(p,{align:"right",children:(h=t==null?void 0:t.content)==null?void 0:h.length}),e.jsx(p,{align:"right",children:t==null?void 0:t.type}),e.jsx(p,{align:"right",children:t==null?void 0:t.genre}),e.jsxs(p,{align:"right",children:[e.jsx(M,{sx:{p:"10px"},"aria-label":"menu",onClick:()=>{v(t),console.log("hey : ",t)},children:e.jsx(te,{})}),e.jsx(M,{sx:{p:"10px"},onClick:()=>u(t),children:e.jsx(se,{})})]})]},t==null?void 0:t._id)})})]})})})]}),e.jsx(U,{anchor:"right",open:g,onClose:()=>{l(!1)},children:e.jsxs(C,{sx:{maxWidth:500},children:[e.jsxs(D,{id:"modal-modal-title",variant:"h2",component:"h2",align:"center",marginTop:3,children:[d?"Update a list":"Add a list",e.jsx("span",{style:{position:"absolute",top:10,right:5,cursor:"pointer"},onClick:()=>l(!1),children:e.jsx(ie,{})})]}),e.jsx(C,{padding:5,children:e.jsx(de,{callback:m,item:d?r(d._id):null})})]})}),e.jsxs(re,{open:c!=null,onClose:()=>u(null),"aria-labelledby":"delete tag group","aria-describedby":"Dialog displayed to confirm tag group delete",children:[e.jsx(ae,{id:"alert-dialog-title",children:"Delete movie"}),e.jsx(ne,{children:e.jsxs(le,{id:"alert-dialog-description",children:["Are you sure to delete ",c==null?void 0:c.title," ?"]})}),e.jsxs(oe,{children:[e.jsx(b,{onClick:()=>u(null),children:"Cancel"}),e.jsx(b,{onClick:()=>T(c),autoFocus:!0,children:"Delete"})]})]})]})]})}export{Ae as default};
