import{j as e,T as B,r as n,az as D,u as L,ay as o,B as T,a as M,W as P,ab as G,Q as F,R as O}from"./index-UxWg3ezt.js";import{P as U}from"./index-1cljy8ee.js";import{T as E}from"./TextField-EtPTPldC.js";import{C as z}from"./Checkbox-tc_mldm7.js";import{C as H}from"./Container-tCW55QtL.js";import{G as N}from"./Grid-7WI3L6ty.js";import{T as K,a as V,b as Y,c as I,d as j,e as q}from"./TableRow-a8LrD-6U.js";import{E as J,D as $,C as Q,a as X,b as Z,c as ee}from"./Edit-vbW1gcSi.js";import{D as te,a as ie}from"./DialogTitle-Lg5rTFAR.js";import"./FormControl-kAW0uwil.js";import"./OutlinedInput-10KJ4yo_.js";import"./useFormControl-3FAv15pH.js";import"./InputLabel-dtf-HdNi.js";import"./Select-Mt5imv_x.js";import"./react-is.production.min-pGgGHoNV.js";import"./FormHelperText-tsMyAYUM.js";import"./SwitchBase-IHTtuvnj.js";function re(){return e.jsxs(e.Fragment,{children:[e.jsx(B,{variant:"h3",component:"h3",gutterBottom:!0,children:"Movies"}),e.jsx(B,{variant:"subtitle2",children:"Manage movies"})]})}function ne(s,{insertAt:a}={}){if(!s||typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],d=document.createElement("style");d.type="text/css",a==="top"&&r.firstChild?r.insertBefore(d,r.firstChild):r.appendChild(d),d.styleSheet?d.styleSheet.cssText=s:d.appendChild(document.createTextNode(s))}ne(`.rti--container *{box-sizing:border-box;transition:all .2s ease}.rti--container{--rti-bg: #fff;--rti-border: #ccc;--rti-main: #3182ce;--rti-radius: .375rem;--rti-s: .5rem;--rti-tag: #edf2f7;--rti-tag-remove: #e53e3e;--rti-tag-padding: .15rem .25rem;align-items:center;background:var(--rti-bg);border:1px solid var(--rti-border);border-radius:var(--rti-radius);display:flex;flex-wrap:wrap;gap:var(--rti-s);line-height:1.4;padding:var(--rti-s)}.rti--container:focus-within{border-color:var(--rti-main);box-shadow:var(--rti-main) 0 0 0 1px}.rti--input{border:0;outline:0;font-size:inherit;line-height:inherit;width:50%}.rti--tag{align-items:center;background:var(--rti-tag);border-radius:var(--rti-radius);display:inline-flex;justify-content:center;padding:var(--rti-tag-padding)}.rti--tag button{background:none;border:0;border-radius:50%;cursor:pointer;line-height:inherit;padding:0 var(--rti-s)}.rti--tag button:hover{color:var(--rti-tag-remove)}
`);function W(s,a){let r=n.useRef(!1);n.useEffect(()=>{r.current?s():r.current=!0},a)}function _(...s){return s.filter(a=>a).join(" ")}function se({text:s,remove:a,disabled:r,className:d}){let c=b=>{b.stopPropagation(),a(s)};return D.createElement("span",{className:_("rti--tag",d)},D.createElement("span",null,s),!r&&D.createElement("button",{type:"button",onClick:c,"aria-label":`remove ${s}`},"âœ•"))}var ae=["Enter"],le=({name:s,placeHolder:a,value:r,onChange:d,onBlur:c,separators:b,disableBackspaceRemove:h,onExisting:p,onRemoved:x,disabled:v,isEditOnRemove:g,beforeAddValidate:C,onKeyUp:i,classNames:m})=>{let[l,k]=n.useState(r||[]);W(()=>{d&&d(l)},[l]),W(()=>{JSON.stringify(r)!==JSON.stringify(l)&&k(r)},[r]);let y=u=>{u.stopPropagation();let f=u.target.value;if(!f&&!h&&l.length&&u.key==="Backspace"&&(u.target.value=g?`${l.at(-1)} `:"",k([...l.slice(0,-1)])),f&&(b||ae).includes(u.key)){if(u.preventDefault(),C&&!C(f,l))return;if(l.includes(f)){p&&p(f);return}k([...l,f]),u.target.value=""}},A=u=>{k(l.filter(f=>f!==u)),x&&x(u)};return D.createElement("div",{"aria-labelledby":s,className:"rti--container"},l.map(u=>D.createElement(se,{key:u,className:m==null?void 0:m.tag,text:u,remove:A,disabled:v})),D.createElement("input",{className:_("rti--input",m==null?void 0:m.input),type:"text",name:s,placeholder:a,onKeyDown:y,onBlur:c,disabled:v,onKeyUp:i}))};const oe=({callback:s,item:a})=>{const[r,d]=n.useState(""),[c,b]=n.useState(""),[h,p]=n.useState(""),[x,v]=n.useState(""),[g,C]=n.useState(""),[i,m]=n.useState(""),[l,k]=n.useState([]),[y,A]=n.useState(!1),u=L(),f=t=>{var S;d(t.title),b(t.desc),p(t.video),C(t.img),m(t.year),v(t.trailer),k(((S=t==null?void 0:t.genre)==null?void 0:S.split(","))??[]),A((t==null?void 0:t.isSeries)??!1)},w=n.useCallback(()=>{const t={title:r,desc:c,video:h,img:g,imgTitle:g,trailer:x,year:i,genre:l.join(","),isSeries:y};o.loading("saving...",{position:"top-right"}),u.createMovie(t).then(()=>{o.dismiss(),o.success("saved",{position:"top-right"}),s&&s()}).catch(S=>{o.dismiss(),o.error("failed",{position:"top-right"}),console.error(S)})},[r,c,h,g,i,x,l,y]),R=n.useCallback(()=>{const t={title:r,desc:c,video:h,img:g,imgTitle:g,trailer:x,year:i,genre:l.join(","),isSeries:y};o.loading("saving...",{position:"top-right"}),u.updateMovie(a._id,t).then(()=>{o.dismiss(),o.success("saved",{position:"top-right"}),s&&s()}).catch(S=>{o.dismiss(),o.error("failed",{position:"top-right"}),console.error(S)})},[r,c,h,g,i,x,l,a,y]);return n.useEffect(()=>{a!=null&&f(a)},[a]),e.jsx(e.Fragment,{children:e.jsxs(T,{component:"form",sx:{"& .MuiTextField-root":{m:1}},children:[g?e.jsx(T,{sx:{width:"100%",height:"100px",display:"flex",justifyContent:"center"},children:e.jsx("img",{src:g,style:{height:"100%"}})}):null,e.jsx(E,{label:"Title",fullWidth:!0,required:!0,value:r,onChange:t=>{d(t.target.value)}}),e.jsx(E,{label:"Description",fullWidth:!0,multiline:!0,value:c,onChange:t=>{b(t.target.value)}}),e.jsx(E,{label:"Trailer link",fullWidth:!0,value:x,onChange:t=>{v(t.target.value)}}),e.jsx(E,{label:"Video link",fullWidth:!0,value:h,onChange:t=>{p(t.target.value)}}),e.jsx(E,{label:"Image link",fullWidth:!0,value:g,onChange:t=>{C(t.target.value)}}),e.jsx(E,{label:"Year",fullWidth:!0,value:i,onChange:t=>{m(t.target.value)}}),e.jsxs(T,{margin:1,sx:{"& .MuiTextField-root":{m:1}},children:[e.jsx(B,{children:"Genres"}),e.jsx(le,{value:l,onChange:t=>k(t)})]}),e.jsxs(T,{margin:1,sx:{"& .MuiTextField-root":{m:1}},children:[e.jsx(z,{checked:y,onClick:()=>A(t=>!t)})," ",e.jsx(B,{component:"span",children:"Is serie"})]}),e.jsx(T,{marginLeft:1,marginTop:3,children:a?e.jsx(M,{variant:"contained",onClick:R,children:"Update"}):e.jsx(M,{variant:"contained",onClick:w,children:"Save"})})]})})};function Ee(){const[s,a]=n.useState(!1),[r,d]=n.useState([]),[c,b]=n.useState(null),[h,p]=n.useState(null),x=L(),v=n.useCallback(()=>{o.loading("loading...",{position:"top-right"}),x.getMovies().then(i=>{o.dismiss(),d(i)})},[]),g=n.useCallback(i=>r.find(m=>m._id===i),[r]),C=n.useCallback(i=>{i!=null&&(o.loading("loading...",{position:"top-right"}),x.deleteMovie(i==null?void 0:i._id).then(()=>{o.dismiss(),o.success("deleted",{position:"top-right"}),p(null),v()}).catch(m=>{o.dismiss(),o.error("failed",{position:"top-right"}),console.error(m),p(null)}))},[]);return n.useEffect(()=>{v()},[]),n.useEffect(()=>{if(c!=null){const i=g(c._id);a(!!i)}},[c]),n.useEffect(()=>{s||b(null)},[s]),e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsx("title",{children:"Movies - Configurations"})}),e.jsx(U,{children:e.jsx(re,{})}),e.jsxs(H,{maxWidth:"lg",children:[e.jsxs(N,{container:!0,direction:"row",justifyContent:"center",alignItems:"stretch",spacing:3,children:[e.jsx(N,{item:!0,xs:12,children:e.jsx(M,{variant:"contained",onClick:()=>a(!0),children:"Add movie"})}),e.jsx(N,{item:!0,xs:12,children:e.jsx(K,{component:G,children:e.jsxs(V,{"aria-label":"simple table",children:[e.jsx(Y,{children:e.jsxs(I,{children:[e.jsx(j,{children:"Title"}),e.jsx(j,{align:"right",children:"Link"}),e.jsx(j,{align:"right",children:"is serie"}),e.jsx(j,{align:"right",children:"Genres"}),e.jsx(j,{align:"right",children:"Actions"})]})}),e.jsx(q,{children:r.map(i=>e.jsxs(I,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(j,{component:"th",scope:"row",children:i.title}),e.jsx(j,{align:"right",children:e.jsx("a",{href:i.video,target:"_blank",children:"see"})}),e.jsx(j,{component:"th",scope:"row",children:i.isSeries?"Yes":"No"}),e.jsx(j,{align:"right",children:i.genre}),e.jsxs(j,{align:"right",children:[e.jsx(F,{sx:{p:"10px"},"aria-label":"menu",onClick:()=>b(i),children:e.jsx(J,{})}),e.jsx(F,{sx:{p:"10px"},onClick:()=>p(i),children:e.jsx($,{})})]})]},i._id))})]})})})]}),e.jsx(O,{anchor:"right",open:s,onClose:()=>{a(!1)},children:e.jsxs(T,{sx:{maxWidth:500},children:[e.jsxs(B,{id:"modal-modal-title",variant:"h2",component:"h2",align:"center",marginTop:3,children:[c?"Update a movie":"Add a movie",e.jsx("span",{style:{position:"absolute",top:10,right:5,cursor:"pointer"},onClick:()=>a(!1),children:e.jsx(Q,{})})]}),e.jsx(T,{padding:5,children:e.jsx(oe,{callback:v,item:c?g(c._id):null})})]})}),e.jsxs(te,{open:h!=null,onClose:()=>p(null),"aria-labelledby":"delete tag group","aria-describedby":"Dialog displayed to confirm tag group delete",children:[e.jsx(ie,{id:"alert-dialog-title",children:"Delete movie"}),e.jsx(X,{children:e.jsxs(Z,{id:"alert-dialog-description",children:["Are you sure to delete ",h==null?void 0:h.title," ?"]})}),e.jsxs(ee,{children:[e.jsx(M,{onClick:()=>p(null),children:"Cancel"}),e.jsx(M,{onClick:()=>C(h),autoFocus:!0,children:"Delete"})]})]})]})]})}export{Ee as default};
